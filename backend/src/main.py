"""
–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç:
- –º–∞—Ä—à—Ä—É—Ç—ã —á–µ—Ä–µ–∑ `router`,
- CORS-–ø–æ–ª–∏—Ç–∏–∫—É –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, Vite –Ω–∞ –ø–æ—Ä—Ç—É 5173).

–°—É—â–Ω–æ—Å—Ç–∏
========

- app : FastAPI
    –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ FastAPI, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º–æ–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞.

CORS
====

–†–∞–∑—Ä–µ—à–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (origins):
- http://localhost:5173
- http://127.0.0.1:5173
- http://localhost:3000
- http://127.0.0.1:3000

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã CORS:
- allow_credentials=True
- allow_methods=["*"]
- allow_headers=["*"]

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
===========

- `src.router.router` ‚Äî –æ–±—ä–µ–∫—Ç –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ —Å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏.

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
====================

.. code-block:: bash

    uvicorn src.main:app --reload

–∏–ª–∏ —á–µ—Ä–µ–∑ `python main.py` (–µ—Å–ª–∏ –º–æ–¥—É–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω).
"""

from fastapi import FastAPI
from src.router import router
from fastapi.middleware.cors import CORSMiddleware

app = FastAPI()
app.include_router(router)

origins = [
    "http://localhost:5173",  # –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
    "http://127.0.0.1:5173",  # –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
    "http://localhost:3000",  # –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É —á–µ—Ä–µ–∑ localhost (–ø–æ—Ä—Ç 3000, –≥–¥–µ Nginx)
    "http://127.0.0.1:3000",  # –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—É —á–µ—Ä–µ–∑ localhost (–ø–æ—Ä—Ç 3000, –≥–¥–µ Nginx)
    "http://backend:8000",    # üí° –î–ª—è —Å–≤—è–∑–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ —Å –±—ç–∫–µ–Ω–¥–æ–º –≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏
]   

app.add_middleware(
    CORSMiddleware,
    allow_origins=origins,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
